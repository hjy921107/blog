---
title: CentOS_7_基本命令
date: 2017-09-17 22:55:24
category: Linux
tags: CentOS 7
---

<!-- toc -->

---

# 1. 常见命令格式

命令 [选项] [参数]

注意：

- 除个别命令不遵循此格式，其余都使用上述格式。
- 当有多个选项时，可以简写在一起
- 选项分为简化选项和完整选项，如 -a 等价于 --all

# 2. 常见命令

## 2.1 查询目录中的内容

ls [选项] [文件或目录]

选项：

- -a 显示所有文件，包括隐藏文件
- -l 显示详细信息， ll 是 ls -l 的别名
- -d 查看目录相关属性信息
- -h 个性化显示文件大小，默认文件大小以字节为单位，使用此选项，可转换成以 k/g 等为单位的数值，更方便阅读
- -i 显示 inode，类似于文件在系统中的 id 号

## 2.2 文件处理命令

### 2.2.1 目录/文件处理命令

#### 2.2.1.1 建立目录

mkdir [选项] [目录名]

选项：

- -p 递归创建

#### 2.2.1.2 切换所在目录

cd [目录]

常见简化命令：

- cd ~/cd 进入当前用户的家目录，如 /root，/home/test
- cd - 进入上次目录
- cd .. 返回上一级目录
- cd . 进入当前目录

#### 2.2.1.3 查询所在目录位置

pwd

#### 2.2.1.4 删除空目录

rmdir

注意：只能删除空目录，基本不用，通常使用下面的命令

####  2.2.1.5 删除文件或目录

rm [选项] [文件或目录]

选项：

- -r 递归处理，主要用于操作目录
- -f 强制删除，不再显示是否确认删除的提示，直接删除

#### 2.2.1.6 复制文件/目录

cp [选项] 原文件或目录 目标文件或目录

选项：

- -r 递归处理，主要用于操作目录
- -p 连带文件目录属性一起复制
- -d 若源文件是链接文件，则复制链接属性
- -a 相当于 -pdr

#### 2.2.1.7 剪切或重命名文件/目录

mv 原文件或目录 目标文件或目录的完整名称

注意：

- 此命令对目录和文件的操作是一致的，对于目录操作没有 cp/rm 中的 -r 选项。
- 如果原文件/目录与目标文件/目录在同一个路径下，即为重命名；否则为剪切。
- 如果目标文件没有指定文件名，剪切后文件名不变；否则使用指定的文件名。

### 2.2.2 链接命令

ln [选项] 原文件 目标文件

选项：

- 选项为空，即默认值，创建硬链接
- -s 创建软链接

说明：

- 如果目标文件只指定了目录，表示链接文件仍使用原文件名；否则使用指定的文件名。
- 创建软链接时，如果原文件和软链接不在同一目录下，那么原文件必须使用绝对路径，否则软链接无法找到该原文件。建议：统一使用绝对路径。

## 2.3 文件搜索命令

### 2.3.1 locate

格式：locate 文件名

按文件名（且只能按文件名）进行搜索

说明：

- 此命令需要安装 mlocate 包，使用 yum -y install mlocate 命令来完成安装。
- 此命令并非遍历所有文件进行搜索，而是搜索一个数据库文件：/var/lib/mlocate/mlocate.db，所以此命令的效率较 find 要高出很多
- 由于是搜索数据文件，所以，对于刚安装该包的情况，需要先生成对应的数据文件，使用命令：updatedb
- 此数据文件默认是每天更新，所以对于当天新建的文件/目录是无法搜索到的，此时需要手动更新，使用命令：updatedb

优缺点：

- 优点：查询效率高，占用资源少
+ 缺点
	- 需要安装 mlocate 包，并且手动生成和更新数据文件
	- 搜索功能并不强大，仅能通过文件名进行搜索

配置文件：

mlocate 的搜索依赖于 /etc/updatedb.conf 配置文件，此配置文件中主要有如下几个参数：

- PRUNE_BIND_MOUNTS = "yes" 开启搜索限制，使用下面的配置生效
- PRUNEFS 不搜索此参数列出的文件系统
- PRUNENAMES 不搜索此参数列出的文件类型，如：.git .hg .svn
- PRUNEPATHS 不搜索此参数列出的文件目录中的文件，如：/media /mnt /tmp /var/tmp

### 2.3.2 whereis

格式：whereis [选项] 命令名

搜索系统命令的命令，搜索命令所在的路径及帮助文件所有位置

选项：

- -b 只查找可执行文件
- -m 只查找帮助文档

### 2.3.3 which

格式：which 命令名

搜索系统命令的命令，搜索命令所在的路径及该命令的别名（完整命令）

注意：

whereis 和 which 命令比较相似，都是搜索系统命令的命令，但不是所有的系统命令都能通过这两个命令来找到对应的路径的。

### 2.3.4 find

格式：find scope 选项 [condition]

选项（常见）：

- -name 按照文件名进行搜索，condition 为文件名
- -iname 文件名不区分大小写搜索，condition 为文件名
- -user 按照文件所有者进行搜索，condition 为 user
- -nouser 查找没有所有者的文件，没有 condition
+ time 按照相关时间进行搜索，condtion 为时间，默认单位是天，如：+10 代表 10 天前，10 代表第 10 天当天，-10 代表 10 天内。
	- -atime 按照文件访问时间进行搜索
	- -ctime 按照文件属性的修改时间进行搜索
	- -mtime 按照文件内容的修改时间进行搜索
+ -size 按照文件大小进行搜索，condition 为文件大小， 默认单位为计算机硬盘单个扇区的大小，通常为 512k，建议带单位：k，M（注意大小写）
	- -25k 小于 25k 的文件
	- 25k 等于 25k 的文件
	- \+ 25k 大于 25k 的文件
- -inum 按照 inode 的值进行搜索
- 逻辑运算符，用于多条件查询，如 find /root -size +10k -a -size -1M
	- -a and 逻辑与，两个条件同时满足
	- -o or 逻辑或，两个条件满足其一即可
- -exec 命令 {} \;，对查询结果执行指定的命令，**注意：`-exec` 和 `{} \;` 是固定格式**，如：find /root -name abc -exec rm -rf {} \;将查询到的结果文件删除
说明：

- find 是非常强大的搜索命令，相对的，使用 find 搜索非常耗费系统资源
- 避免使用大范围搜索，即 scope 的值尽量使用更小的、更明确的目录
+ find 支持通配符操作，使用时建议用引号括起来，否则，有可能不能识别。主要支持的通配符有：
	- \* 匹配任意内容
	- ? 匹配任意一个字符
	- [abc] 匹配中括号中的任意一个字符


### 2.3.5 grep

格式：grep [选项] 字符串 文件名

在文件中搜索符合条件的字符串，支持模糊查询，需要使用正则表达式。

选项：

- -i 忽略大小写
- -v 排除指定字符串

## 2.4 帮助命令

### 2.4.1 man

获取指定命令的帮助信息，全称为 manual，帮助手册的意思

格式：man [选项] 命令

选项：

- -f 查看命令拥有哪些级别的帮助，相当于 whatis 命令
- -k 查看与命令相关的所有帮助信息，找到的不一定都是命令，相当于 apropos 命令
- man 的级别（1-9 级别描述见下），如 man 1 ls

**man 的级别**

1. 可执行程序或 shell 命令
2. 由内核提供的系统调用的方法
3. 程序库调用的库中的方法
4. 特殊文件，主要是 /dev 中的文件
5. 配置文件
6. 游戏
7. 其它杂项
8. 系统管理员命令，通常给 root 用户使用
9. 内核相关

级别不同，代表该命令的不同使用情况，对于含有多个 man 级别的命令，默认只会查找级别最低的那个帮助信息，此时，就需要使用 man 的级别选项来指定需要的对应 man 级别的命令的帮助信息。

### 2.4.2 获取选项帮助

格式：命令 --help

列出当前命令支持的所有选项及对应的说明使用

### 2.4.3 shell 内部命令帮助

格式：shell 命令 help

仅对 shell 命令有效，其他命令的帮助使用 man

### 2.4.4 详细命令帮助 info

格式：info 命令

列出该命令相关的所有帮助信息，说明相当详细，篇幅过多，适合作为完整文档进行学习，不利于快速查找，操作较繁琐。

主要操作：

- Enter 在带有 \* 的目录上回车可跳转到该小节的具体说明
- u 跳转到上层目录
- n 跳转到下一小节
- p 跳转到上一小节
- q 退出

## 2.5 压缩命令

Linux 对于压缩文件，在显示详细信息时，文件名的颜色会和普通文件不同，通常为红色。

### 2.5.1 .zip 格式

此格式与 windows 中的 zip 完全兼容，可以在两个系统间交叉地进行压缩和解压缩

#### 2.5.1.1 压缩

格式：zip [选项] 目标文件 源文件

选项：

- -r 递归处理，主要用于操作目录

说明：

- 目标文件在前，源文件在后
- 如果目标文件没有 .suffix，此命令会自动为其加上 .zip 的后缀；否则直接使用指定的文件名（如 abc.txt），建议指定 .zip 的后缀，不规则的后缀名容易导致解压错误、不方便识别和管理。

#### 2.5.1.2 解压缩

格式：unzip 源文件 [选项] 参数

说明：

- 解压缩文件或目录的命令格式完成一致，解压缩目录不需要使用 -r 选项。
- 指定解压的路径：unzip abc.zip -d /root，将当前目录下的 abc.zip 解压到 /root 下。**注意：此处的参数是目录不是文件名，如果指定文件名，会多出一层指定文件名的目录；解压的文件名默认为压缩文件去掉后缀名**

### 2.5.2 .gz 格式

#### 2.5.2.1 压缩

格式：gzip [选项] 源文件

选项：

- -c 保持源文件不改变， 将压缩后的文件输出到指定目标中（控制台，文件等）
- -r 递归处理，主要用于操作目录

此命令在压缩完成后不保留源文件

说明：

- 此命令会自动在当前目录产生一个与源文件同名的，以 .gz 为后缀的压缩文件
- 由于此压缩命令不支持保留源文件的操作，可以结合 -c 使用 gzip -c test > /tmp/test.gz，即：保留 test 源文件，将压缩后的文件写入到目标文件 /tmp/test.gz 中
- 此命令对于目录的压缩，并非压缩目录本身，而是递归地压缩目录中的文件

### 2.5.2.1 解压缩

格式： gzip -d [选项] 压缩文件 / gunzip [选项] 压缩文件

选项：

- -c 保持压缩文件不变，将解压后的文件输出到指定目标中
- -r 递归处理，主要用于操作目录

将压缩文件解压到指定文件：在原有命令后增加 > 目标文件

### 2.5.3 .bz2 格式

#### 2.5.3.1 压缩

格式：bzip [选项] 源文件

选项：

- -k 保留源文件

说明：

- 此命令会自动在当前目录产生一个与源文件同名的，以 .bz2 为后缀的压缩文件
- 默认情况下，此压缩命令不保留源文件，需要保留时，使用 -k 选项
- 此命令不支持压缩目录

#### 2.5.3.2 解压缩

格式 bzip2 -d [选项] 压缩文件 / bunzip2 [选项] 压缩文件

选项：

-k 保留压缩文件

## 2.6 打包与压缩 tar

除了上面提到的三种压缩格式（.zip, .gz, .bz2），其实更常用的是：.tar.gz，.tar.bz2，所以，相比于 2.5 中的压缩命令，Linux 中更常用的 tar 命令，它集成了打包与压缩命令，能更好地处理目录的压缩，建议使用此命令。

### 2.6.1 打包

格式：tar [选项] 目标包名 源文件

选项：

- -c 打包
- -v 显示打包的详细过程信息
- -f 指定打包后的目标包名

### 2.6.2 解包

格式：tar [选项] 包文件名

选项：

- -x 解包
- -v 显示解饭详细过程信息
- -f 指定需要解包的文件名

### 2.6.3 压缩

其实，.tar.gz/.tar.bz2 格式文件就是先打包为 .tar 文件，再压缩为 .gz/.bz2 文件。我们可以通过先使用 tar 命令打包再使用 gzip/bzip2 命令的方式完成操作，但相对麻烦，所以 tar 命令提供了更加便捷的方式。

格式：tar [选项] 目标压缩包名 源文件

选项：

- -z 指定格式为 .tar.gz
- -j 指定格式为 .tar.bz2
- -c 打包压缩
- -v 显示详细过程信息
- -f 指定打包压缩后的目标包名

### 2.6.4 解压缩

格式：tar [选项] 包文件名

选项：

- -z 指定格式为 .tar.gz
- -j 指定格式为 .tar.bz2
- -x 解包解压缩
- -v 显示详细过程信息
- -f 指定需要解包的文件名

## 2.7 注销、关机和重启

### 2.7.1 shutdown

格式：shutdown [选项] [时间]

选项：

- -c 取消之前使用 shutdown 指定的关机或重启命令
- -h 关机
- -r 重启

说明：

- 默认情况下，即直接使用 shutdown 命令，不加任何参数，就是指关机命令，但不是立刻，而是一分钟后；如果加上对应选项，但没指定时间，默认也是等待一分钟

例：

- shutdown -h now 立即关机
- shutdown -r 16:00 在指定的时间重启

### 2.7.2 其他关机/重启命令

关机：

- halt
- poweroff
- init 0

重启：

- reboot (相对安全，可以使用)
- init 6

相对于 shutdown 命令，上述命令并不是太好，可能会出现一些文件丢失、硬件损坏的情况，不建议使用。

## 2.7.3 注销

格式：logout

建议不使用时就注销

## 2.8 挂载与卸载

### 2.8.1 查询与自动挂载

- mount 查询系统中已经挂载的设备
- mount -a 依据配置文件 /etc/fstab 的内容，进自动挂载

### 2.8.2 挂载命令

格式：mount [-t 文件系统] [-o 特殊选项] 设备文件名 挂载点

选项：

- -t 指定挂载设备的文件系统类型，如 CentOS7 默认的 ext4，光盘默认的 iso9660 等文件系统
- -o 指定挂载时的额外选项，常见的参数如下：

	| 参数 | 说明 |
	| --- | --- |
	| atime/noatime | 访问分区文件时是否更新访问时间，默认为更新 |
	| async/sync | 异步/同步 |
	| auto/noauto | mount -a 命令执行时，是否会自动安装 /etc/fstab 文件中配置的挂载点 |
	| defautls | 默认值，相当于指定 rw,suid,dev,exec,auto,nouser,async 这七个选项 |
	| exec/noexec | 设定是否允许在文件系统中执行可执行文件，默认是 exec 允许|
	| remount | 重新挂载已经挂载的分区，一般用于指定特殊挂载选项后的分区刷新 |
	| rw/ro | 指定挂载分区内文件的读写权限：读写/只读，默认为读写 |
	| suid/nosuid | 挂载分区时是否具有 SUID 的权限，默认是具有 |
	| user/nouser | 挂载分区时指定分区是否允许普通用户挂载，默认是不允许，只有 root 用户可以挂载分区 |
	| usrquota | 指定分区是否支持用户磁盘配额，默认不支持 |
	| grpquota | 指定分区是否支持组磁盘配额，默认不支持 |

- 设备文件名，不同的设备系统会自动分配对应的设备文件名，常见的如：光盘 -> /dev/sr0,/dev/cdrom，
- 挂载点，任意空目录都可以作为挂载点，如系统自带的 /，/home，/mnt 等

说明：

- 关于上述挂载的额外选项，如果没有明确的需求，不建议修改默认值
- 关于 exec/noexec 选项，如果在挂载分区时设置值为 noexec，此时，对于分区内的可执行文件，即使是 root 用户，文件也确实具有可执行权限，执行时也会提示 permission denies

#### 2.8.2.1 挂载光盘

1. 建立挂载点
	mkdir /mnt/cdrom/ ，挂载点可以是任意的空目录，不过 Linux 已经提供了这样的空目录：/mnt，/media，建议使用 /mnt，/media 是后期新增的，并不是所有 Linux 的版本都具有，所以，更常见的是在 /mnt 下自定义空目录挂载相应的分区
2. 挂载光盘
	mount -t iso9660 /dev/sr0 /mnt/cdrom/，对于光盘来说，-t 选项是可以省略的，因为系统为自动识别到需要挂载的分区为光盘，然后设置文件分区的文件系统为 iso9660；设备文件名 /dev/sr0 是 Linux 默认提供的，当然也可以使用 /dev/cdrom，不过此设备文件名其实是 /dev/sr0 的一个软链接，所以，建议还是使用 /dev/sr0；挂载点即创建的空目录

#### 2.8.2.2 挂载 U 盘

1. 查看 U 盘的设备文件名，对于光盘，该设备文件名就是确定的 /dev/sr0 或者 /dev/cdrom，而对于 U 盘，需要通过命令查看：fdisk -l，此命令会列出当前系统下的所有磁盘设备相关信息
2. 创建挂载点
	mkdir /mnt/usb/
3. 挂载 U 盘
	mount -t vfat /dev/sdb1 /mnt/usb/，关于文件系统，此处使用的是 fat32，目前最为常见的 U 盘文件系统，支持多操作系统，注意：Linux/Unix 默认是不支持 NTFS 文件系统的。

### 2.8.3 卸载命令

格式：umount 设备文件名/挂载点

说明：

- 设备文件名和挂载点只能写一个
- 卸载时，必须退出挂载点所在目录，否则无法卸载
- 对于任何外置分区，用完之后必须卸载

举例：umount /dev/sr0 == umount /mnt/cdrom/

## 2.9 用户登录查询相关命令

### 2.9.1 w

输出信息：

+ 统计信息
	- 当前时间
	- up ... 至今为止的开机时间
	- ... users 此次开机后登录过后用户个数
	- load average ... ... ... 三段时间分别表示系统在一/五/十五分钟内的平均负载情况，值越大，系统压力越大
- USER 当前登录的用户名
- TTY 使用的登录终端
- FROM 登录的 IP 地址
- LOGIN@ 登录时间
- IDLE 用户闲置时间
- JCPU 和终端连接人所有进程占用的时间。这个时间里并不包括过去的后台作业，但包括当前正在运行的后台作业所占用的时间
- PCPU 当前进程所占用的时间
- WHAT 当前执行的命令

### 2.9.2 who

输出信息：

用户名 登录终端 登录时间(IP 地址)

### 2.9.3 last

此命令是查询当前登录和过去登录的所有用户的信息，实质是读取 /var/log/wtmp 文件数据，不过此文件保存的都是二进制数据，无法直接通过编辑器直接查看，也是防止有人恶意访问后修改自己的访问记录。

输出信息：

用户名 登录终端 登录IP 登录时间 退出时间（在线时长）

### 2.9.4 lastlog

此命令是查询系统中所有用户最后一次登录系统的时间

输出信息：

用户名 登录终端 登录IP 最后一次登录时间

## 3. 其他命令

### 3.1 输出命令

格式：echo [选项] [输出内容]

选项：

+ -e 支持反斜线控制的字符转换
	+ 常见的反斜线控制的字符：
		- \a 输出警告音
		- \b 退格键，即向左删除键
		- \n 换行符
		- \r 回车键
		- \t 制表符，即 tab 键
		- \v 垂直制表符
		- \0nnn 八进制，nnn 为三位八进制数
		- \xhh 十六进制，hh 为十六进制数
	+ 颜色控制，格式：echo -e "\e[1;30mChina\e[0m"，常见颜色如下：
		- 30m 黑色
		- 31m 红色
		- 32m 绿色
		- 33m 黄色
		- 34m 蓝色
		- 35m 洋红
		- 36m 青色
		- 37m 白色

注意：

- 双引号与单引号：两者都可用来引用内容，但双引号中使用 "!"（英文字符） 会报错

### 3.2 统计内容命令

格式：wc [选项] [文件名]

选项：

- -c 统计内容的字节数
- -w 统计内容的单词数
- -l 统计内容的行数

说明：默认情况下，即未指定需要统计的文件名，此命令统计的对象是键盘录入，结束录入的方法是 Ctrl + d ，如当前行有录入内容，使用两次快捷键，如当前行无内容，一次即可。

## Tips

1. 显示系统时间：date
2. 显示系统相关编码：locale [-a]
3. 输出系统的环境变量：echo \$PATH, echo \$SHELL, echo \$HOSTNAME 等
4. 创建文件：touch 文件名
5. 分屏查看文件内容：more 文件名
